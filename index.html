<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Radio Als Chromecast 2</title>
  <script src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1"></script>
  <style>
    body {
      background: black;
      color: white;
      font-family: sans-serif;
      text-align: center;
      padding-top: 50px;
    }
    #cast-button {
      background: none;
      border: none;
      width: 64px;
      height: 64px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Radio Als Chromecast Player</h1>
  <button id="cast-button" title="Cast to Chromecast">
    <img src="https://www.gstatic.com/cast/sdk/icons/button_cast_white.svg" alt="Cast" width="100%">
  </button>

  <script>
    window['__onGCastApiAvailable'] = function(isAvailable) {
      if (!isAvailable) return;

      const context = cast.framework.CastContext.getInstance();
      context.setOptions({
        receiverApplicationId: chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,
        autoJoinPolicy: chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED
      });

      document.getElementById("cast-button").addEventListener("click", async () => {
        try {
          const session = await context.requestSession();
          const mediaInfo = new chrome.cast.media.MediaInfo(
            'https://corsproxy.io/?https://stream.classicpop.dk/radioals',
            'audio/mpeg'
          );
          mediaInfo.metadata = new chrome.cast.media.MusicTrackMediaMetadata();
          mediaInfo.metadata.title = "Radio Als - Classic Pop";

          const request = new chrome.cast.media.LoadRequest(mediaInfo);
          session.loadMedia(request).then(
            () => console.log("Casting started"),
            (err) => console.error("Load failed:", err)
          );
        } catch (e) {
          console.error("Cast failed:", e);
        }
      });
    };
  </script>
</body>
</html>
